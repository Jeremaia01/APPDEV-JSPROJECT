<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pokemon Habitat Info</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
    }
    .container {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px;
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    h1, h2 {
        text-align: center;
    }
    #pokemonList {
        list-style-type: none;
        padding: 0;
    }
    .pokemon-item {
        margin-bottom: 10px;
        padding: 10px;
        background-color: #f9f9f9;
        border-radius: 5px;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Pokemon Habitat Info</h1>
    <label for="habitat">Select Habitat:</label>
    <select id="habitat">
        <!-- Placeholder option -->
        <option value="all">All Habitats</option>
    </select>
    <button onclick="fetchPokemonData()">Get Pokemon in Habitat</button>
    <ul id="pokemonList"></ul>
</div>
<script>
    // Function to fetch all habitats and populate the dropdown
    function fetchAllHabitats() {
        const apiUrl = 'https://pokeapi.co/api/v2/pokemon-habitat/';
        
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                populateHabitatDropdown(data);
            })
            .catch(error => {
                console.error('There was a problem with your fetch operation:', error);
                alert('Failed to fetch data. Please try again.');
            });
    }

    // Function to populate the habitat dropdown with options
    function populateHabitatDropdown(data) {
        const habitatDropdown = document.getElementById('habitat');

        // Add individual habitats
        data.results.forEach(habitat => {
            const option = document.createElement('option');
            option.value = habitat.name;
            option.textContent = habitat.name;
            habitatDropdown.appendChild(option);
        });
    }

    // Function to fetch Pokemon data based on selected habitat
    function fetchPokemonData() {
        const selectedHabitat = document.getElementById('habitat').value.trim().toLowerCase();

        // Construct the API URL based on the selected habitat
        let apiUrl = 'https://pokeapi.co/api/v2/pokemon-habitat/';
        if (selectedHabitat !== 'all') {
            apiUrl += selectedHabitat + '/';
        }

        fetch(apiUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                displayPokemonData(data);
            })
            .catch(error => {
                console.error('There was a problem with your fetch operation:', error);
                alert('Failed to fetch data. Please try again.');
            });
    }

    // Function to display Pokemon data in the list
    function displayPokemonData(data) {
        const pokemonListElement = document.getElementById('pokemonList');
        pokemonListElement.innerHTML = '';

        data.pokemon_species.forEach(pokemon => {
            const listItem = document.createElement('li');
            listItem.className = 'pokemon-item';
            listItem.textContent = pokemon.name;
            pokemonListElement.appendChild(listItem);
        });
    }

    // Load all habitats when the window loads
    window.onload = function() {
        fetchAllHabitats();
    };

    // Navbar toggle
    const navTog = document.querySelector('.nav-toggle');
    const links = document.querySelector('.links');

    navTog.addEventListener('click', () => {
        links.classList.toggle('show-links');
    });

    // Load all Pokémon when the window loads
    async function getAllPokemons() {
        const response = await fetch('https://pokeapi.co/api/v2/pokemon/?limit=1000');
        const data = await response.json();
        const pokemonList = document.getElementById("pokemonList");
        if (data.results.length > 0) {
            pokemonList.innerHTML = ""; // Clear previous Pokémon
            for (const pokemon of data.results) {
                await displayPokemon(pokemon.url);
            }
        } else {
            pokemonList.innerHTML = "<p>No Pokémon found.</p>";
        }
    }

    async function getPokemonsByType(type) {
        const response = await fetch(`https://pokeapi.co/api/v2/type/${type}`);
        const data = await response.json();
        const pokemonList = document.getElementById("pokemonList");
        if (data.pokemon.length > 0) {
            pokemonList.innerHTML = ""; // Clear previous Pokémon
            for (const entry of data.pokemon) {
                await displayPokemon(entry.pokemon.url);
            }
        } else {
            pokemonList.innerHTML = `<p>No ${type} type Pokémon found.</p>`;
        }
    }

    async function displayPokemon(url) {
        const response = await fetch(url);
        const data = await response.json();
        const pokemonContainer = document.getElementById("pokemonList");
        const pokemonDiv = document.createElement("div");
        pokemonDiv.classList.add("pokemon");
        const pokemonName = capitalizeFirstLetter(data.name);
        pokemonDiv.innerHTML = `<img src="${data.sprites.front_default}" alt="${pokemonName}"><p>${pokemonName}</p>`;
        pokemonContainer.appendChild(pokemonDiv);
    }

    function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
    }

    // Load all Pokémon when the window loads
    window.onload = function() {
        getAllPokemons();
    };
</script>
</body>
</html>
